<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs/%3E%3Cpath d='M32 6c8 10-4 14 4 24s-4 14 4 24' fill='none' stroke='%23ff7a59' stroke-width='6' stroke-linecap='round'/%3E%3C/svg%3E" />
<title>Sauna Finder & Community</title>
<link href="https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.css" rel="stylesheet" />
<link href="styles.css" rel="stylesheet" />
</head>
<body>
  <header class="nav">
    <div class="container nav-inner">
      <div class="logo">
        <div class="logo-mark"></div>
        <span>Sauna Finder</span>
      </div>
      <nav class="nav-links">
        <a href="#spots">Spots</a>
        <a href="#discover">Discover</a>
        <a href="#community">Community</a>
      </nav>
      <a class="cta" href="#get-started">Get started</a>
    </div>
  </header>

  <section class="hero" id="home">
    <div class="container">
      <div class="hero-card" aria-label="Hero">
        <div class="hero-media">
          <img src="assets/hero-loyly.jpg" alt="Seaside deck and wooden facade of Löyly in Helsinki" />
        </div>
        <div class="hero-content">
          <div class="hero-text">
            <span class="eyebrow">Helsinki sauna culture</span>
            <h1>Find heat. Book bliss. Meet your sauna people.</h1>
            <p class="sub">Discover iconic public saunas and hidden gems around Helsinki. Explore images from real locations and plan your next löyly.</p>
            <div class="actions">
              <a class="btn primary" href="#spots">Browse featured spots</a>
              <a class="btn" href="#discover">Search and filter</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section" id="spots">
    <div class="container">
      <h2>Featured Helsinki saunas</h2>
      <p class="lead">Curated highlights from the Helsinki region.</p>
      <div class="grid" id="spot-grid">
        <article class="spot">
          <img src="assets/allas-sea-pool.jpg" alt="Swimmers at Allas Sea Pool by Helsinki harbor" />
          <div class="spot-body">
            <div class="spot-title">
              <strong>Allas Sea Pool</strong>
              <span class="badge">Harbor • Public</span>
            </div>
            <div class="meta">Warm and cold pools, year-round sauna next to the sea.</div>
          </div>
        </article>
        <article class="spot">
          <img src="assets/sipoonjoki-traditional.jpg" alt="Rustic smoke sauna entrance at Sipoonjoki in the forest" />
          <div class="spot-body">
            <div class="spot-title">
              <strong>Sipoonjoki Traditional Sauna</strong>
              <span class="badge">Smoke • Countryside</span>
            </div>
            <div class="meta">Authentic smoke sauna experience immersed in nature.</div>
          </div>
        </article>
        <article class="spot">
          <img src="assets/lonna-terrace.jpg" alt="People relaxing on Lonna island sauna terrace by the sea" />
          <div class="spot-body">
            <div class="spot-title">
              <strong>Lonna Sauna</strong>
              <span class="badge">Island • Wood-fired</span>
            </div>
            <div class="meta">Modern island saunas with traditional stoves and sea views.</div>
          </div>
        </article>
      </div>
      <p class="meta" style="margin-top:10px;">Images: <a href="https://www.visitfinland.com/en/articles/must-experience-saunas-in-helsinki-region/" target="_blank" rel="noopener">Visit Finland</a></p>
    </div>
  </section>

  <section class="section container discovery" id="discover">
    <h2>Discover saunas</h2>
    <p class="lead">Search by city, type, and price to find your next session.</p>

    <div class="filters">
      <input id="filter-city" class="input" type="text" placeholder="City (e.g., Helsinki)" />
      <select id="filter-type" class="select">
        <option value="">Any type</option>
        <option value="public">Public</option>
        <option value="private">Private</option>
        <option value="smoke">Smoke sauna</option>
        <option value="wood">Wood-fired</option>
        <option value="electric">Electric</option>
      </select>
      <select id="filter-price" class="select">
        <option value="">Any price</option>
        <option value="$">$</option>
        <option value="$$">$$</option>
        <option value="$$$">$$$</option>
      </select>
    </div>

    <div class="split">
      <div class="panel list" id="list"></div>
      <div class="panel map">
        <div class="board" id="map-board" aria-label="Map placeholder">
          <div id="mapbox" class="mapbox" role="region" aria-label="Map"></div>
        </div>
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <span>© <span id="year"></span> Sauna Finder • Images © respective owners</span>
    </div>
  </footer>

  <div class="modal" id="modal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <img class="modal-media" id="modal-img" alt="Sauna photo" />
      <div class="modal-body">
        <h3 id="modal-title"></h3>
        <p class="meta" id="modal-meta"></p>
        <p id="modal-desc"></p>
      </div>
      <div class="modal-actions">
        <button class="btn" id="modal-close">Close</button>
        <a class="btn primary" id="modal-book" href="#book">Request booking</a>
      </div>
    </div>
  </div>

  <script src="https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.js"></script>
  <script>
    // Year in footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Mapbox token configuration - replace with your token
    const MAPBOX_TOKEN = window.localStorage.getItem('MAPBOX_TOKEN') || 'YOUR_MAPBOX_ACCESS_TOKEN';

    // Dataset (Helsinki highlights) with assets/ images
    const saunas = [
      { id: 's1', name: 'Löyly', city: 'Helsinki', type: 'public', price: '$$', rating: 4.8, lat: 60.1552, lng: 24.9240, img: 'assets/loyly-deck.jpg', desc: 'Iconic seaside sauna with wood-fired heat and a large terrace.' },
      { id: 's2', name: 'Allas Sea Pool', city: 'Helsinki', type: 'public', price: '$$', rating: 4.6, lat: 60.1674, lng: 24.9556, img: 'assets/allas-sea-pool.jpg', desc: 'Urban pools and saunas by the harbor, open year-round.' },
      { id: 's3', name: 'Lonna Sauna', city: 'Helsinki', type: 'wood', price: '$$', rating: 4.7, lat: 60.1649, lng: 24.9768, img: 'assets/lonna-terrace.jpg', desc: 'Island saunas with traditional stoves and sea views.' },
      { id: 's4', name: 'Kulttuurisauna', city: 'Helsinki', type: 'electric', price: '$', rating: 4.5, lat: 60.1753, lng: 24.9563, img: 'assets/kulttuurisauna.jpg', desc: 'Minimalist, eco-minded sauna on the waterfront; peaceful and design-forward.' },
      { id: 's5', name: 'Kotiharjun Sauna', city: 'Helsinki', type: 'wood', price: '$', rating: 4.6, lat: 60.1870, lng: 24.9620, img: 'assets/kotiharju-street.jpg', desc: 'Historic wood-heated public sauna (since 1928) in Kallio.' },
      { id: 's6', name: 'Kuusijärvi', city: 'Vantaa', type: 'smoke', price: '$$', rating: 4.6, lat: 60.3376, lng: 25.0802, img: 'assets/kuusijarvi-lake.jpg', desc: 'Recreational area with electric and smoke saunas by the lake.' },
      { id: 's7', name: 'Sipoonjoki Traditional', city: 'Sipoo', type: 'smoke', price: '$$$', rating: 4.8, lat: 60.3640, lng: 25.3520, img: 'assets/sipoonjoki-traditional.jpg', desc: 'Authentic ground-built smoke sauna surrounded by forest.' }
    ];

    // Elements
    const listEl = document.getElementById('list');
    const mapBoard = document.getElementById('map-board');
    const mapboxContainer = document.getElementById('mapbox');
    const filterCity = document.getElementById('filter-city');
    const filterType = document.getElementById('filter-type');
    const filterPrice = document.getElementById('filter-price');

    // Modal elements
    const modal = document.getElementById('modal');
    const modalImg = document.getElementById('modal-img');
    const modalTitle = document.getElementById('modal-title');
    const modalMeta = document.getElementById('modal-meta');
    const modalDesc = document.getElementById('modal-desc');
    const modalClose = document.getElementById('modal-close');

    function closeModal() { modal.classList.remove('open'); document.body.style.overflow = ''; }
    modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
    modalClose.addEventListener('click', closeModal);
    window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

    // Filtering
    function applyFilters(items) {
      const city = filterCity.value.trim().toLowerCase();
      const type = filterType.value;
      const price = filterPrice.value;
      return items.filter(s => {
        if (city && !s.city.toLowerCase().includes(city)) return false;
        if (type && s.type !== type) return false;
        if (price && s.price !== price) return false;
        return true;
      });
    }

    filterCity.addEventListener('input', render);
    filterType.addEventListener('change', render);
    filterPrice.addEventListener('change', render);

    // Placeholder map (fallback)
    const bounds = { minLat: 59.5, maxLat: 70.0, minLng: 20.0, maxLng: 31.6 };
    function project(lat, lng) {
      const x = (lng - bounds.minLng) / (bounds.maxLng - bounds.minLng) * 100;
      const y = (1 - (lat - bounds.minLat) / (bounds.maxLat - bounds.minLat)) * 100;
      return { x, y };
    }

    let map; // mapbox instance
    let mapMarkers = [];

    function ensureMapbox() {
      if (!window.mapboxgl) return false;
      if (!MAPBOX_TOKEN || MAPBOX_TOKEN === 'YOUR_MAPBOX_ACCESS_TOKEN') return false;
      mapboxgl.accessToken = MAPBOX_TOKEN;
      if (!map) {
        map = new mapboxgl.Map({
          container: mapboxContainer,
          style: 'mapbox://styles/mapbox/streets-v12',
          center: [24.9384, 60.1699],
          zoom: 9,
        });
        map.addControl(new mapboxgl.NavigationControl({ visualizePitch: true }), 'top-right');
      }
      return true;
    }

    function clearMapboxMarkers() {
      mapMarkers.forEach(m => m.remove());
      mapMarkers = [];
    }

    function renderMap(items) {
      const hasMapbox = ensureMapbox();
      if (hasMapbox) {
        clearMapboxMarkers();
        if (items.length) {
          const first = items[0];
          map.jumpTo({ center: [first.lng, first.lat], zoom: 9 });
        }
        items.forEach(s => {
          const el = document.createElement('div');
          el.className = 'marker';
          el.textContent = '★ ' + s.price;
          el.style.pointerEvents = 'auto';
          el.addEventListener('click', () => {
            modalImg.src = s.img;
            modalTitle.textContent = s.name;
            modalMeta.textContent = `${s.city} • ${s.type} • ${s.price} • ★ ${s.rating}`;
            modalDesc.textContent = s.desc;
            modal.classList.add('open');
            document.body.style.overflow = 'hidden';
          });
          const marker = new mapboxgl.Marker(el).setLngLat([s.lng, s.lat]).addTo(map);
          mapMarkers.push(marker);
        });
        return;
      }
      // Fallback placeholder
      mapBoard.style.position = 'relative';
      mapBoard.innerHTML = '';
      items.forEach(s => {
        const { x, y } = project(s.lat, s.lng);
        const m = document.createElement('div');
        m.className = 'marker';
        m.style.left = x + '%';
        m.style.top = y + '%';
        m.textContent = '★ ' + s.price;
        m.title = s.name + ' — ' + s.city;
        m.addEventListener('click', () => {
          modalImg.src = s.img;
          modalTitle.textContent = s.name;
          modalMeta.textContent = `${s.city} • ${s.type} • ${s.price} • ★ ${s.rating}`;
          modalDesc.textContent = s.desc;
          modal.classList.add('open');
          document.body.style.overflow = 'hidden';
        });
        mapBoard.appendChild(m);
      });
    }

    // List rendering
    function renderList(items) {
      if (!items.length) {
        listEl.innerHTML = '<div class="spot" style="grid-template-rows:auto;">\n  <div class="spot-body"><strong>No results</strong><div class="meta">Try broadening your filters.</div></div>\n</div>';
        return;
      }
      listEl.innerHTML = items.map(s => `
        <div class=\"item\" data-id=\"${s.id}\">\n          <img class=\"thumb\" src=\"${s.img}\" alt=\"${s.name}\" />\n          <div>\n            <div style=\"display:flex; align-items:center; gap:8px;\">\n              <strong>${s.name}</strong>\n              <span class=\"badge\">${s.city}</span>\n            </div>\n            <div class=\"meta\">${s.type} • <span class=\"price\">${s.price}</span> • ★ ${s.rating}</div>\n          </div>\n          <button class=\"btn\" data-open=\"${s.id}\">Details</button>\n        </div>
      `).join('');

      listEl.querySelectorAll('[data-open]').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const id = e.currentTarget.getAttribute('data-open');
          const s = saunas.find(x => x.id === id);
          if (!s) return;
          modalImg.src = s.img;
          modalTitle.textContent = s.name;
          modalMeta.textContent = `${s.city} • ${s.type} • ${s.price} • ★ ${s.rating}`;
          modalDesc.textContent = s.desc;
          modal.classList.add('open');
          document.body.style.overflow = 'hidden';
        });
      });
    }

    function render() {
      const filtered = applyFilters(saunas);
      renderList(filtered);
      renderMap(filtered);
    }

    render();
  </script>
</body>
</html>
